"use strict";var app;!function(e){angular.module("app",["ui.router","ngResource","ngAnimate","ui.mask","ngMap"]).config(["$stateProvider","$locationProvider","$httpProvider","$urlRouterProvider",function(t,o,r,n){t.state("Home",{url:"/",templateUrl:"/templates/home.html",controller:e.Controllers.HomeController,controllerAs:"vm"}).state("Login",{url:"/login",templateUrl:"/templates/login.html",controller:e.Controllers.UserController,controllerAs:"vm"}).state("Register",{url:"/register",templateUrl:"/templates/register.html",controller:e.Controllers.UserController,controllerAs:"vm"}).state("UserAccount",{url:"/account",templateUrl:"/templates/userAccountPage.html",controller:e.Controllers.EditUserController,controllerAs:"vm"}).state("Appointments",{url:"/appointments",templateUrl:"/templates/appointments.html",controller:e.Controllers.AppointmentController,controllerAs:"vm"}).state("ManageHairstyles",{url:"/styles",templateUrl:"/templates/ManageHairstyles.html",controller:e.Controllers.HairstyleController,controllerAs:"vm"}).state("EditHairstyle",{url:"/editstyle/:id",templateUrl:"/templates/EditHairstyle.html",controller:e.Controllers.EditHairstyleController,controllerAs:"vm"}).state("BookAppointment",{url:"/appointment/:username",templateUrl:"/templates/EditHairstyle.html",controller:e.Controllers.BookAppointmentController,controllerAs:"vm"}).state("Profile",{url:"/barber/:username",templateUrl:"/templates/profilePage.html",controller:e.Controllers.ProfileController,controllerAs:"vm"}).state("RSVPDone",{url:"/reservationcomplete",templateUrl:"/templates/RSVPDone.html",controller:e.Controllers.HomeController,controllerAs:"vm"}),n.otherwise("/"),o.html5Mode(!0),r.interceptors.push("HTTPFactory")}]).run(["$rootScope","$animate",function(e,t){t.enabled(!1),e.pageanimate=!1,e.toggleAnimate=function(){e.pageanimate===!0?(e.pageanimate=!1,t.enabled(!1),console.log(e.pageanimate)):(e.pageanimate=!0,t.enabled(!0),console.log(e.pageanimate))}}])}(app||(app={})),angular.module("app").directive("backImg",function(){return function(e,t,o){var r=o.backImg;t.css({"background-image":"url("+r+")","background-size":"cover",background:"#310736",background:"-moz-linear-gradient(45deg, #310736 0%, #ff5c5c 100%)",background:"-webkit-linear-gradient(45deg, #310736 0%,#ff5c5c 100%)",background:"linear-gradient(45deg, #310736 0%,#ff5c5c 100%)",filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='#310736', endColorstr='#ff5c5c',GradientType=1 )"})}}),angular.module("app").directive("datePicker",function(){return{restrict:"A",link:function(e,t,o){var r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate()+5);console.log(n),console.log(r),$("#date").calendar({onChange:function(e){$("#leDate").val(e).trigger("change")},type:"date",minDate:r,maxDate:n,formatter:{date:function(e,t){return e?e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear():""}}}),$("#time").calendar({onChange:function(e){$("#leTime").val(e.toTimeString()).trigger("change")},type:"time"}),$("#calDatePicker").calendar({onChange:function(e){$("#pickedDayVal").val(e.toDateString()).trigger("change")},type:"date"}),$("#calDatePickerMobile").calendar({onChange:function(e){$("#pickedDayValMobile").val(e.toDateString()).trigger("change")},type:"date"})}}}),angular.module("app").directive("dropdown",function(){return{restrict:"A",link:function(e,t,o){$(".ui.dropdown").dropdown()}}}),angular.module("app").directive("footer",function(){return{templateUrl:"../../templates/footer.html",restrict:"E"}}),angular.module("app").directive("apptModal",function(){return{restrict:"A",link:function(e,t,o){$("#hiddenBtn").click(function(){$(".ui.modal").modal("show")})}}}),angular.module("app").directive("navbar",function(){return{templateUrl:"../../templates/navbar.html",restrict:"E",controller:"NavbarController",controllerAs:"nc"}}),angular.module("app").directive("tabMenu",function(){return{restrict:"A",link:function(e,t,o){$(".menu>[data-tab=first]").tab(),$(".menu>[data-tab=second]").tab(),$(".menu>[data-tab=third]").tab()}}});var app;!function(e){!function(e){var t=function(){function e(){}return e}();e.HaircutComponent=t,angular.module("app").component("haircutList",t)}(e.Components||(e.Components={}))}(app||(app={}));var moment,app;!function(e){!function(e){var t=function(){function e(e,t,o){var r=this;this.AppointmentService=e,this.UserService=t,this.$location=o,this.appointments=[],this.user={isTakingWalkins:Boolean},this.apptArr=[],e.getAllBarberAppointments().then(function(e){r.appointments=e}),t.getUser(t.status.username).then(function(e){r.user=e.data,console.log(r.user)}),this.isMobile=window.innerWidth<=990;var n=(new Date).toDateString(),i=n.split(" ").splice(0,4);this.today=i.join(" "),this.showNav=!0}return e.$inject=["AppointmentService","UserService","$location"],e.prototype.resetDate=function(){this.date=""},e.prototype.showModal=function(e){console.log("This is the selected appointment id: "+e.appointmentDate),this.modalAppt=e,document.getElementById("hiddenBtn").click()},e.prototype.sendReminder=function(){this.AppointmentService.sendMessage({messageType:"reminder",apptDate:this.modalAppt.appointmentDate,apptTime:this.modalAppt.appointmentTime,client_num:this.modalAppt.phone}).then(function(e){alert(e.message)})},e.prototype.sendCancel=function(){var e=this;this.modalAppt.status="cancelled",this.AppointmentService.setStatus(this.modalAppt).then(function(t){e.AppointmentService.sendMessage({messageType:"cancellation",apptDate:e.modalAppt.appointmentDate,apptTime:e.modalAppt.appointmentTime,client_num:e.modalAppt.phone}).then(function(e){alert(e.message)})})},e.prototype.toggleWalkin=function(){var e=this.user;console.log(e.isTakingWalkins),e.isTakingWalkins=!this.user.isTakingWalkins,console.log(e),this.UserService.setWalkin(e).then(function(e){console.log(e)})},e}();e.AppointmentController=t,angular.module("app").controller("AppointmentController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o){this.AppointmentService=e,this.UserService=t,this.$location=o}return e.$inject=["AppointmentService","UserService","$location"],e.prototype.submitAppt=function(){var e=this;this.appointment.status="Active",this.AppointmentService.saveAppt(this.appointment).then(function(t){e.$location.path("/appointments")})},e}();e.BookAppointmentController=t,angular.module("app").controller("BookAppointmentController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var moment,app;!function(e){!function(e){var t=function(){function e(e,t,o){var r=this;this.AppointmentService=e,this.UserService=t,this.$location=o,e.getAllBarberAppointments().then(function(e){r.appointments=e}),this.isMobile=window.innerWidth<=990,console.log(this.isMobile),console.log(window.innerWidth)}return e.$inject=["AppointmentService","UserService","$location"],e.prototype.setDate=function(){var e=this.date.split(" ").splice(0,3);this.dateString=e.join(" "),console.log("the date is "+this.date)},e.prototype.resetDate=function(){this.date=""},e}();e.EditAppointmentController=t,angular.module("app").controller("EditAppointmentController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o){this.HairstyleService=e,this.$state=t,this.$stateParams=o,this.hairstyle=e.getHairstyle(o.id),console.log(o.id)}return e.$inject=["HairstyleService","$state","$stateParams"],e.prototype.update=function(){var e=this;this.HairstyleService.updateHairstyle(this.hairstyle).then(function(t){e.$state.go("ManageHairstyles",{},{reload:!0})})},e}();e.EditHairstyleController=t,angular.module("app").controller("EditHairstyleController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o,r){var n=this;this.IGConverterService=e,this.UserService=t,this.$window=o,this.$state=r,t.getUser(t.status.username).then(function(e){e.data.igurl&&(n.alreadyUploaded=!0,console.log("Ig url has already been uploaded: "+n.alreadyUploaded)),n.user=e.data,console.log(n.user)})}return e.$inject=["IGConverterService","UserService","$window","$state"],e.prototype.updateProfile=function(){var e=this;this.user.address=this.user.streetAddress+" "+this.user.city+", "+this.user.state,this.geocoder(function(){e.IGConverterService.getIgUrl(e.user.igurl).then(function(t){e.user.igurl=t.image,console.log(e.user),e.UserService.updateUserInfo(e.user).then(function(t){console.log(t),e.alreadyUploaded=!0,alert("Update successful")})})})},e.prototype.geocoder=function(e){var t=this;(new google.maps.Geocoder).geocode({address:this.user.address},function(o,r){r==google.maps.GeocoderStatus.OK&&o.length>0?(t.user.location=o[0].geometry.location,e()):console.log("Could not find address, make sure you are using a valide address.")})},e}();e.EditUserController=t,angular.module("app").controller("EditUserController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(){this.homepage=!0}return e}();e.GlobalController=t,angular.module("app").controller("GlobalController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o,r){this.HairstyleService=e,this.UserService=t,this.$window=o,this.$state=r,this.hairstyle={},this.editedStyle={},this.styles=[],this.editing=!1,this.styles=e.getUserHairstyles(),console.log(this.styles)}return e.$inject=["HairstyleService","UserService","$window","$state"],e.prototype.addHairstyle=function(){var e=this;console.log("hitting"),this.HairstyleService.saveHairstyle(this.hairstyle).then(function(t){e.hairstyle=null,console.log(t.name),e.styles.push(t)})},e.prototype.delete=function(e){var t=this;this.HairstyleService.deleteHairstyle(e._id).then(function(o){t.styles.splice(t.styles.indexOf(e),1),console.log(o.message)})},e.prototype.showEdit=function(){this.editing,this.editing,console.log(this.editing)},e}();e.HairstyleController=t,angular.module("app").controller("HairstyleController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(){console.log("wtf")}return e}();e.HomeController=t,angular.module("app").controller("HomeController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o,r,n){this.UserService=e,this.$state=t,this.$location=o,this.$window=r,this.$animate=n,this.UserService.getToken()&&(this.status=e.status,console.log("navbar should show: "+this.status.username))}return e.$inject=["UserService","$state","$location","$window","$animate"],e.prototype.logout=function(){this.showNav=!1,console.log("showNav="+this.showNav),this.UserService.removeToken(),this.UserService.removeUser(),this.$state.go("Home",{},{reload:!0}),this.$animate.enabled(!1)},e}();e.NavbarController=t,angular.module("app").controller("NavbarController",t)}(e.Controller||(e.Controller={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o,r,n){var i=this;this.AppointmentService=e,this.UserService=t,this.$stateParams=o,this.$location=r,this.$scope=n,this.loading=!1,this.appointment={barber:String,appointmentDay:String,appointmentDate:String,date:String,time:String},t.getUser(o.username).then(function(e){i.profile=e.data,i.appointment.barber=i.profile._id,i.$scope.position=[i.profile.location.lat,i.profile.location.lng],console.log(i.$scope.position)});var s=new Date;this.maxDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+5),this.googleMapsUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyCLJoF1zdrJ7OmtYYw37yDyN7JHJpC-moI"}return e.$inject=["AppointmentService","UserService","$stateParams","$location","$scope"],e.prototype.submitAppt=function(){var e=this;this.loading=!0;var t=this.AppointmentService.convertDate(this.appointment);t.status="active";var o=t;this.AppointmentService.saveAppt(o).then(function(t){console.log(t),e.$location.path("/reservationcomplete")})},e}();e.ProfileController=t,angular.module("app").controller("ProfileController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o){this.UserService=e,this.$window=t,this.$state=o,this.loading=!1,this.other=!1}return e.$inject=["UserService","$window","$state"],e.prototype.showOther=function(){this.other=!0,console.log("hello")},e.prototype.register=function(){var e=this;this.loading=!0,this.userInfo.profession2&&(this.userInfo.profession=this.userInfo.profession2);this.userInfo;this.userInfo.isTakingWalkins=!1,console.log(this.userInfo),this.UserService.register(this.userInfo).then(function(t){e.$window.localStorage.setItem("token",t.token),e.UserService.setUser(),e.$state.go("UserAccount",{},{reload:!0})}).catch(function(t){e.loading=!1,console.log(t)})},e.prototype.login=function(){var e=this;this.loading=!0,this.UserService.login(this.userInfo).then(function(t){e.$window.localStorage.setItem("token",t.token),e.UserService.setUser(),e.$state.go("Appointments",{},{reload:!0})}).catch(function(t){e.loading=!1,alert(t.data.data)})},e}();e.UserController=t,angular.module("app").controller("UserController",t)}(e.Controllers||(e.Controllers={}))}(app||(app={})),angular.module("app").filter("showActiveAppointments",function(){return function(e){for(var t=[],o=0;o<e.length;o++){e[o].date>new Date&&t.push(e[o])}return t}});var app;!function(e){!function(e){var t=function(){function e(e,t,o){this.$resource=e,this.$http=t,this.$q=o,this.AppointmentResource=e("/api/v1/appointments/:id",null,{update:{method:"PUT"}}),this.twilioAPIResource=e("/api/v1/twilio")}return e.$inject=["$resource","$http","$q"],e.prototype.saveAppt=function(e){return this.AppointmentResource.save(e).$promise},e.prototype.getAllBarberAppointments=function(){return this.AppointmentResource.query().$promise},e.prototype.sendMessage=function(e){return this.twilioAPIResource.save(e).$promise},e.prototype.setStatus=function(e){var t=this.$q.defer();return this.$http.put("/api/v1/appointments",e).then(function(e){t.resolve(e.data)},function(e){t.reject(e)}),this.AppointmentResource.update(e).$promise},e.prototype.convertDate=function(e){var t=e.appointmentDate.split(" ").splice(0,4);e.appointmentDate=t.join(" ");var o=new Date(e.appointmentDate);e.date=moment(o).format("YYYY-M-D");var r=e.appointmentTime.split(" ")[0],n=r.split(":")[0],i=r.split(":")[1];return n>12?n-12>0&&(r=n-12+":"+i+" pm"):r=12==n?n+":"+i+" pm":n+":"+i+" am",e.appointmentTime=r,console.log(e),e},e}();e.AppointmentService=t,angular.module("app").service("AppointmentService",t)}(e.Services||(e.Services={}))}(app||(app={}));var app;!function(e){!function(e){angular.module("app").factory("HTTPFactory",["$window",function(e){return{request:function(t){return t.headers=t.headers||{},t.headers.Accepts="application/json",t.headers["Content-Type"]="application/json",e.localStorage.getItem("token")&&(t.headers.Authorization="Bearer "+e.localStorage.getItem("token")),t}}}])}(e.Services||(e.Services={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e){this.$resource=e,this.HairstyleResource=e("/api/v1/hairstyles/:id",null,{update:{method:"PUT"}}),this.UserHairstylesResource=e("/api/v1/hairstyles/user")}return e.$inject=["$resource"],e.prototype.saveHairstyle=function(e){return this.HairstyleResource.save(e).$promise},e.prototype.getAll=function(){return this.HairstyleResource.query()},e.prototype.deleteHairstyle=function(e){return this.HairstyleResource.delete({_id:e}).$promise},e.prototype.getUserHairstyles=function(){return this.UserHairstylesResource.query()},e.prototype.updateHairstyle=function(e){return this.HairstyleResource.update({id:e._id},e).$promise},e.prototype.getHairstyle=function(e){return this.HairstyleResource.get({id:e})},e}();e.HairstyleService=t,angular.module("app").service("HairstyleService",t)}(e.Services||(e.Services={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e){this.$resource=e,this.igapiresource=e("api/v1/igurl")}return e.$inject=["$resource"],e.prototype.getIgUrl=function(e){var t={};return t.url=e,this.igapiresource.save(t).$promise},e}();e.IGConverterService=t,angular.module("app").service("IGConverterService",t)}(e.Services||(e.Services={}))}(app||(app={}));var app;!function(e){!function(e){var t=function(){function e(e,t,o,r,n){this.IGConverterService=e,this.$resource=t,this.$window=o,this.$http=r,this.$q=n,this.status={_id:Number,username:String,email:String},this.UserResource=t("api/v1/users"),this.UserRegisterResource=t("api/v1/users/register"),this.UserLoginResource=t("api/v1/users/login"),this.getToken()&&this.setUser()}return e.$inject=["IGConverterService","$resource","$window","$http","$q"],e.prototype.register=function(e){return console.log(e),this.UserRegisterResource.save(e).$promise},e.prototype.login=function(e){return this.UserLoginResource.save(e).$promise},e.prototype.setUser=function(){var e=JSON.parse(atob(this.$window.localStorage.getItem("token").split(".")[1]));this.status._id=e._id,this.status.username=e.username,this.status.email=e.email,this.status.isTakingWalkins=e.isTakingWalkins},e.prototype.removeToken=function(){this.$window.localStorage.removeItem("token")},e.prototype.removeUser=function(){this.status._id=null,this.status.username=null,this.status.email=null,this.status.isTakingWalkins=null},e.prototype.getToken=function(){return this.$window.localStorage.getItem("token")},e.prototype.getUserHairstyles=function(){return this.UserResource.query().$promise},e.prototype.getUser=function(e){var t=this.$q.defer();return this.$http.get("/api/v1/users/"+e).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},e.prototype.updateUserInfo=function(e){var t=this.$q.defer();return this.$http.put("/api/v1/users",e).then(function(e){t.resolve(e.data)},function(e){console.error("Error trying to update user information",e),t.reject(e)}),t.promise},e.prototype.setWalkin=function(e){var t=this.$q.defer();return this.$http.put("/api/v1/users/status",e).then(function(e){t.resolve(e.data)},function(e){t.reject(e)}),t.promise},e}();e.UserService=t,angular.module("app").service("UserService",t)}(e.Services||(e.Services={}))}(app||(app={}));